From f36f71f60b1e68c0f12e615b9b128d089ec3dd19 Mon Sep 17 00:00:00 2001
From: Bastien Nocera <hadess@hadess.net>
Date: Fri, 7 Jun 2019 09:51:33 +0200
Subject: [PATCH] tools: Fix build after y2038 changes in glibc

The 32-bit SIOCGSTAMP has been deprecated. Use the deprecated name
to fix the build.
---
 tools/l2test.c | 6 +++++-
 tools/rctest.c | 6 +++++-
 2 files changed, 10 insertions(+), 2 deletions(-)

Index: bluez/tools/l2test.c
===================================================================
--- bluez.orig/tools/l2test.c
+++ bluez/tools/l2test.c
@@ -59,6 +59,10 @@
 #define SIOCGSTAMP_OLD SIOCGSTAMP
 #endif
 
+#ifndef SIOCGSTAMP_OLD
+#define SIOCGSTAMP_OLD SIOCGSTAMP
+#endif
+
 /* Test modes */
 enum {
 	SEND,
Index: bluez/tools/rctest.c
===================================================================
--- bluez.orig/tools/rctest.c
+++ bluez/tools/rctest.c
@@ -54,6 +54,10 @@
 #define SIOCGSTAMP_OLD SIOCGSTAMP
 #endif
 
+#ifndef SIOCGSTAMP_OLD
+#define SIOCGSTAMP_OLD SIOCGSTAMP
+#endif
+
 /* Test modes */
 enum {
 	SEND,
